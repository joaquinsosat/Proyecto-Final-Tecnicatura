<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Imperio Gamer - Carrito</title>
    <link rel="icon" href="imagenes/Inicio/logoimperiokratos.jpg" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <div class="logo">
        <img src="imagenes/Inicio/logoimperiokratos.jpg" alt="logoimperiokratos" width="150">
    </div>
    <nav class="main-nav">
        <button class="menu-toggle" aria-expanded="false" aria-controls="menu-list">‚ò∞</button>
        <ul class="nav-menu" id="menu-list">
            <li><a href="index.html">Inicio</a></li>
            <li><a href="tienda.html">Tienda</a></li>
            <li><a href="proximamente.html">Pr√≥ximamente</a></li>
            <li><a href="contacto.html">Contacto</a></li>
            <li><a href="carritodecompras.html">Carrito</a></li>
            <li id="logout-item" style="display: none;">
                <a href="#" id="logout-button">Cerrar Sesi√≥n üîì</a>
            </li>
        </ul>
    </nav>
</header>

    <main>
    <div class="carrito-container">
        
        <h2>üõí Tu Carrito de Compras</h2>

        <div id="cart-items-list">
            </div>

        <div class="carrito-resumen">
            <h2>üè∑Ô∏è Resumen de la Compra</h2>
            <div class="resumen-detalle">
                <span>Subtotal:</span>
                <span id="subtotal"></span>
            </div>
            <div class="resumen-detalle">
                <span>Costo de Env√≠o:</span>
                <span id="shipping-cost">Gratis</span>
            </div>
            <div class="resumen-total">
                <span>Total:</span>
                <span id="total-price"></span>
            </div>
            <button class="btn-checkout">Proceder al Pago</button>
        </div>
    </div>
</main>

    <footer>
        <p>&copy; 2025 Imperiogamer</p> 
    <div class="links-adicionales"> 
        <a href="tienda.html#comparativa">Ver Tabla de Consolas</a> |
        <a href="#">T√©rminos y Condiciones</a> | 
        <a href="contacto.html#devoluci√≥n / reembolso">Solicitud De Devoluci√≥n</a> 
    </div>
        </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const cartItemsList = document.getElementById('cart-items-list');
        const subtotalDisplay = document.getElementById('subtotal');
        const totalPriceDisplay = document.getElementById('total-price');
        const btnCheckout = document.querySelector('.btn-checkout'); 
        let cart = JSON.parse(localStorage.getItem('imperioGamerCart')) || [];

        function formatCurrency(amount) {
            return `$${amount.toLocaleString('es-AR', { minimumFractionDigits: 0, maximumFractionDigits: 0 })} ARS`;
        }

        function saveCart() {
            localStorage.setItem('imperioGamerCart', JSON.stringify(cart));
            renderCart();
        }

        function calculateTotals() {
            let subtotalARS = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            let totalARS = subtotalARS;
            return { subtotalARS, totalARS };
        }

        function renderCart() {
            cartItemsList.innerHTML = '';
            const { subtotalARS, totalARS } = calculateTotals();

            if (cart.length === 0) {
                cartItemsList.innerHTML = `
                    <p style="text-align: center; padding: 40px; background-color: #1a1a2e; border-radius: 8px;">
                        Tu carrito est√° vac√≠o. ¬°Explora nuestra tienda!
                    </p>
                `;
                subtotalDisplay.textContent = formatCurrency(0);
                totalPriceDisplay.textContent = formatCurrency(0);
                btnCheckout.disabled = true;
                return;
            }
            
            btnCheckout.disabled = false; 
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                const imagePath = `imagenes/Tienda/${item.imageFileName || 'placeholder.jpg'}`;
                const itemHTML = `
                    <article class="carrito-item-card" data-id="${item.id}">
                        <img src="${imagePath}" alt="${item.name}" class="item-imagen">
                        
                        <div class="item-info">
                            <h4 style="font-size: 1.3rem; margin-bottom: 5px; color: white;">${item.name}</h4>
                            <p class="item-plataforma">Plataforma: ${item.plataforma || item.platform}</p>
                        </div>

                        <div class="item-cantidad">
                            <label for="qty-${item.id}">Cant:</label>
                            <input type="number" id="qty-${item.id}" value="${item.quantity}" min="1" data-id="${item.id}" class="input-cantidad">
                        </div>
                        
                        <div class="item-precio-eliminar">
                            <div class="item-precio">
                                <p class="precio">${formatCurrency(itemTotal)}</p> 
                            </div>
                            <button class="btn-eliminar" data-id="${item.id}">Eliminar</button>
                        </div>
                    </article>
                `;
                cartItemsList.innerHTML += itemHTML;
            });

            subtotalDisplay.textContent = formatCurrency(subtotalARS);
            totalPriceDisplay.textContent = formatCurrency(totalARS);
            attachCartListeners();
        }

        function attachCartListeners() {
            document.querySelectorAll('.btn-eliminar').forEach(button => {
                button.addEventListener('click', (e) => {
                    const id = e.target.dataset.id;
                    cart = cart.filter(item => item.id !== id);
                    saveCart();
                });
            });

            document.querySelectorAll('.input-cantidad').forEach(input => {
                input.addEventListener('change', (e) => {
                    const id = e.target.dataset.id;
                    let newQuantity = parseInt(e.target.value);
                    
                    if (isNaN(newQuantity) || newQuantity < 1) {
                         newQuantity = 1;
                         e.target.value = 1;
                    }
                    
                    const item = cart.find(i => i.id === id);
                
                    if (item) {
                        item.quantity = newQuantity;
                    }
                    
                    saveCart();
                });
            });
        }
        btnCheckout.addEventListener('click', () => {
            if (cart.length > 0) {
                window.location.href = 'pago.html'; 
            } else {
                alert('Tu carrito est√° vac√≠o. ¬°Explora nuestra tienda!');
            }
        });

        renderCart();
    });
    
window.handleLogout = () => {
    localStorage.removeItem('isLoggedIn');
    window.location.href = "index.html"; 
};

document.addEventListener('DOMContentLoaded', () => {
    const menuToggle = document.querySelector('.menu-toggle');
    const navMenu = document.querySelector('.nav-menu');

    if (menuToggle && navMenu) {
        menuToggle.addEventListener('click', () => {
            navMenu.classList.toggle('active');
            const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true' || false;
            menuToggle.setAttribute('aria-expanded', !isExpanded);
        });
    }

    const logoutItem = document.getElementById('logout-item');
    const logoutButton = document.getElementById('logout-button');
    const isUserLoggedIn = localStorage.getItem('isLoggedIn') === 'true';

    if (logoutItem) {
        logoutItem.style.display = isUserLoggedIn ? 'block' : 'none';
    }

    if (logoutButton) {
        logoutButton.addEventListener('click', (e) => {
            e.preventDefault();
            window.handleLogout();
        });
    }
});
</script>
    
</body>

</html>

